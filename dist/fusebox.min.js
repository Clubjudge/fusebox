/**
 *  v0.1.0
 *
 * Copyright (c) 2013Bruno Abrantes
 * Distributed under BSD License
 *
 * Documentation and full license available at:
 * http://inf0rmer.github.com/fusebox
 *
 */
(function(){var n,r,e,u,fusebox,t,o,i,s,l,a,c,f;return c=this,i=this.fusebox,r={},t={},o={},f={},n="widgets/",a={},s=require,l=requirejs,e=function(n,r){return null==r&&(r="_"),n.replace(/([A-Z])/g,r+"$1").toLowerCase()},o.extend=function(n){return f=_.extend(f,n)},o.clear=function(){return f={}},o.validate=function(n,r){var e,u;return e=null!=(u=f[r])?u[n]:void 0,e?!0:!1},t.subscribe=function(n,e,u,t){return r[e]=null!=r[e]?r[e]:{},r[e][n]=null!=r[e][n]?r[e][n]:[],r[e][n].push(_.bind(u,t))},t.unsubscribe=function(n){return r[n]=[]},t.publish=function(n,e){var u;return u=[].slice.call(arguments,1),r[e]?r[e][n]&&r[e][n].length?_.each(r[e][n],function(n){return n.apply(this,u)}):void 0:void 0},t.start=function(u){var o,i;return o=[].slice.call(arguments,1),i=e(u),s([n+i+"/main"],function(){var n;return null!=(null!=(n=r[u])?n.bootstrap:void 0)?_.each(r[u].bootstrap,function(n){return n.apply(t,o)}):void 0})},t.stop=function(n){var u,o,i,s;return u=[].slice.call(arguments,1),o=u[0],i=e(n),null!=(null!=(s=r[n])?s.unload:void 0)&&_.each(r[n].unload,function(n){return n.apply(t,u)}),o?$(o).html(""):void 0},t.unload=function(n){var r,e,u,t,o;if(r=null!=(null!=l?l.s.contexts._.urlMap:void 0)){for(o=[],u=0,t=r.length;t>u;u++)e=r[u],r.hasOwnProperty(e)&&-1!==e.indexOf(n)?(s.undef(e),o.push(this.unsubscribe(n))):o.push(void 0);return o}},t.responds=function(n,r){return a[n]=function(){var n;return n=new $.Deferred,r.call(this,n),n},t},t.stopsResponding=function(n){return a[n]=null,delete a[n],t},t.request=function(n){var r;return null!=a[n]?r=a[n]():(r=new $.Deferred,r.reject()),r.promise()},t.dom={find:function(n,r){return null==r&&(r=document),$(r).find(n)},data:function(n,r){return $(n).data(r)}},fusebox={noConflict:function(){return c.fusebox=i,fusebox},subscribe:function(n,r,e){return o.validate(n,r)?t.subscribe(n,r,e,this):void 0},unsubscribe:function(n){return t.unsubscribe(n)},publish:function(){return t.publish.apply(t,arguments)},start:function(){return t.start.apply(t,arguments)},stop:function(){return t.stop.apply(t,arguments)},unload:function(){var r;return r=e(channel),t.unload.apply(t,n+r)},responds:function(){return t.responds.apply(t,arguments)},stopsResponding:function(){return t.stopsResponding.apply(t,arguments)},request:function(){return t.request.apply(t,arguments)},find:function(n,r){return t.dom.find(n,r)},data:function(n,r){return t.dom.data(n,r)},permissions:o,dom:t.dom,setBaseUrl:function(r){return n=r},getBaseUrl:function(){return n},setRequireLib:function(n,r){if(2>arguments.length)throw Error("Both a require function and a requirejs global are needed");if("function"!=typeof n)throw Error("require needs to be a function");return s=n,l=r},getRequireLib:function(){return{require:s,requirejs:l}}},u!==void 0&&null!==u?(null!=("undefined"!=typeof module&&null!==module?module.exports:void 0)&&(u=module.exports=fusebox),u.fusebox=fusebox):c.fusebox=fusebox,fusebox})();